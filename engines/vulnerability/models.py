# engines/vulnerability/models.py
from dataclasses import dataclass, field
from typing import List, Optional, Dict, Any


@dataclass
class VulnerabilitySignal:
    """Low-level vulnerability indicator (NO enforcement logic)."""
    owasp_id: str
    category: str
    subtype: str
    source: str
    file: str
    line: Optional[int] = None
    code: Optional[str] = None
    evidence: List[str] = field(default_factory=list)
    confidence: float = 0.5

    def as_dict(self) -> Dict[str, Any]:
        return {
            "owasp_id": self.owasp_id,
            "category": self.category,
            "subtype": self.subtype,
            "source": self.source,
            "file": self.file,
            "line": self.line,
            "code": self.code,
            "evidence": self.evidence,
            "confidence": self.confidence,
        }


@dataclass
class VulnerabilityFinding:
    """High-level vulnerability finding with severity & context."""
    owasp_id: str
    title: str
    description: str
    severity: str  # LOW | MEDIUM | HIGH | CRITICAL
    category: str
    file: str
    line: Optional[int] = None
    code: Optional[str] = None
    evidence: List[str] = field(default_factory=list)
    confidence: float = 0.8
    cwe: Optional[str] = None

    def as_dict(self) -> Dict[str, Any]:
        return {
            "owasp_id": self.owasp_id,
            "title": self.title,
            "description": self.description,
            "severity": self.severity,
            "category": self.category,
            "file": self.file,
            "line": self.line,
            "code": self.code,
            "evidence": self.evidence,
            "confidence": self.confidence,
            "cwe": self.cwe,
        }
