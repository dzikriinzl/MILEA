from dataclasses import dataclass
from typing import Dict, List, Any

from engines.vulnerability.risk.models import RiskScore


@dataclass
class UnifiedSecurityReport:
    metadata: Dict[str, Any]
    ara: Dict[str, Any]

    vulnerabilities: List[Dict[str, Any]]
    correlated_findings: List[Any]

    risk_score: RiskScore

    summary: Dict[str, Any]
    correlation: Dict[str, Any]

    def as_dict(self):
        return {
            "metadata": self.metadata,
            "ara": self.ara,
            "vulnerabilities": self.vulnerabilities,
            "correlated_findings": [
                f.as_dict() if hasattr(f, "as_dict") else f
                for f in self.correlated_findings
            ],
            "risk_score": self.risk_score.as_dict(),
            "summary": self.summary,
            "correlation": self.correlation,
        }
