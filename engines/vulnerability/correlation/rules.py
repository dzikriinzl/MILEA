# engines/vulnerability/correlation/rules.py
"""
Correlation rules mapping OWASP Mobile Top 10 to protections
"""

CORRELATION_RULES = {
    "M1": {
        "title": "Improper Credentials Usage",
        "depends_on": ["ANTI_INSTRUMENTATION", "ROOT_DETECTION"],
    },
    "M2": {
        "title": "Supply Chain Risks",
        "depends_on": ["ANTI_TAMPERING", "ROOT_DETECTION"],
    },
    "M3": {
        "title": "Authentication Flaws",
        "depends_on": ["ANTI_INSTRUMENTATION", "SSL_PINNING"],
    },
    "M4": {
        "title": "Input Validation Flaws",
        "depends_on": ["ANTI_INSTRUMENTATION"],
    },
    "M5": {
        "title": "Communication Security",
        "depends_on": ["SSL_PINNING"],
    },
    "M6": {
        "title": "Private Data Exposure",
        "depends_on": ["ANTI_TAMPERING", "ROOT_DETECTION"],
    },
    "M7": {
        "title": "Binary Protection",
        "depends_on": ["ANTI_TAMPERING"],
    },
    "M8": {
        "title": "Code Quality",
        "depends_on": [],
    },
    "M9": {
        "title": "Reverse Engineering",
        "depends_on": ["ROOT_DETECTION", "ANTI_TAMPERING"],
    },
    "M10": {
        "title": "Extraneous Functionality",
        "depends_on": ["ANTI_TAMPERING"],
    },
}
