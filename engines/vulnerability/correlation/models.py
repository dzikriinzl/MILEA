# engines/vulnerability/correlation/models.py
from dataclasses import dataclass, field
from typing import List, Dict, Any


@dataclass
class CorrelatedFinding:
    """
    Correlated Finding Object - NOT a dict
    Represents vulnerability with protection context
    """
    owasp_id: str
    title: str
    base_severity: str
    effective_risk: str  # Adjusted by protections
    mitigation_status: str  # MITIGATED | PARTIALLY_MITIGATED | NOT_MITIGATED
    reasoning: List[str] = field(default_factory=list)
    original_finding: Dict[str, Any] = field(default_factory=dict)

    def as_dict(self) -> Dict[str, Any]:
        """Convert to dict for reporting"""
        return {
            "owasp_id": self.owasp_id,
            "title": self.title,
            "base_severity": self.base_severity,
            "effective_risk": self.effective_risk,
            "mitigation_status": self.mitigation_status,
            "reasoning": self.reasoning,
            "original_finding": self.original_finding,
        }
