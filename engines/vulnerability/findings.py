from dataclasses import dataclass, field
from typing import List, Optional


@dataclass
class VulnerabilityFinding:
    owasp_id: str
    title: str
    category: str
    subtype: str

    severity: str
    confidence: float

    description: str
    recommendation: str
    remediation: str

    evidence: List[str] = field(default_factory=list)
    affected_files: List[str] = field(default_factory=list)

    references: List[str] = field(default_factory=list)

    def as_dict(self):
        return {
            "owasp_id": self.owasp_id,
            "title": self.title,
            "category": self.category,
            "subtype": self.subtype,
            "severity": self.severity,
            "confidence": self.confidence,
            "description": self.description,
            "recommendation": self.recommendation,
            "remediation": self.remediation,
            "evidence": self.evidence,
            "affected_files": self.affected_files,
            "references": self.references,
        }
