# engines/vulnerability/manifest/rules.py

MANIFEST_RULES = [

    {
        "id": "debuggable_app",
        "owasp": "M8",
        "category": "SECURITY_MISCONFIGURATION",
        "subtype": "debuggable_enabled",
        "match": lambda m: m.get("debuggable") == "true",
    },

    {
        "id": "allow_backup",
        "owasp": "M9",
        "category": "INSECURE_DATA_STORAGE",
        "subtype": "allow_backup_enabled",
        "match": lambda m: m.get("allowBackup") == "true",
    },

    {
        "id": "cleartext_traffic",
        "owasp": "M5",
        "category": "INSECURE_COMMUNICATION",
        "subtype": "cleartext_traffic_allowed",
        "match": lambda m: m.get("usesCleartextTraffic") == "true",
    },
]
