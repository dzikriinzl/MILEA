from .base import BaseVulnerabilityInferer
from engines.vulnerability.findings import VulnerabilityFinding


class M6PrivacyInferer(BaseVulnerabilityInferer):

    def supported_subtypes(self):
        return ["pii_sent_over_network", "pii_via_intent"]

    def infer(self, signals):
        if not signals:
            return []

        files = list({s.file for s in signals})

        return [
            VulnerabilityFinding(
                owasp_id="M6",
                title="Privacy Leak",
                category="INADEQUATE_PRIVACY_CONTROLS",
                subtype="pii_exposure",
                severity="HIGH",
                confidence=0.85,
                description="Potential leakage of personal data detected.",
                recommendation="Minimize and protect personal data transmission.",
                remediation="Encrypt data and follow privacy-by-design.",
                evidence=[s.code for s in signals[:5]],
                affected_files=files,
            )
        ]
