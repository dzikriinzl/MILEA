# engines/vulnerability/inferer/base.py
from abc import ABC, abstractmethod
from typing import List, Dict, Any
from engines.vulnerability.models import VulnerabilitySignal
from engines.vulnerability.findings import VulnerabilityFinding


class BaseVulnerabilityInferer(ABC):

    @property
    @abstractmethod
    def supported_subtypes(self) -> set[str]:
        """
        Which signal subtypes this inferer can process
        """
        pass

    @abstractmethod
    def infer(
        self,
        signals: List[VulnerabilitySignal],
        context: Dict[str, Any] | None = None,
    ) -> List[VulnerabilityFinding]:
        pass
