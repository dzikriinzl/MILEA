from .base import BaseVulnerabilityInferer
from engines.vulnerability.findings import VulnerabilityFinding


class M8MisconfigurationInferer(BaseVulnerabilityInferer):

    def supported_subtypes(self):
        return ["debuggable_enabled", "allow_backup_enabled"]

    def infer(self, signals):
        if not signals:
            return []

        return [
            VulnerabilityFinding(
                owasp_id="M8",
                title="Security Misconfiguration",
                category="SECURITY_MISCONFIGURATION",
                subtype="debuggable_or_backup",
                severity="MEDIUM",
                confidence=0.75,
                description="Insecure application configuration detected.",
                recommendation="Disable debug and backup in production.",
                remediation="Set debuggable=false and allowBackup=false.",
                evidence=[str(s.evidence) for s in signals],
                affected_files=[],
            )
        ]
