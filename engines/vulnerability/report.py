class VulnerabilityReport:
    def __init__(self, findings):
        self.findings = findings

    def summary(self):
        summary = {}
        for f in self.findings:
            summary[f.subtype] = summary.get(f.subtype, 0) + 1
        return summary

    def as_dict(self):
        return {
            "total": len(self.findings),
            "summary": self.summary(),
            "findings": [f.as_dict() for f in self.findings],
        }
